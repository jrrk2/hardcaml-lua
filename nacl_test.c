
#include <stdio.h>
#include <string.h>
#include <stdint.h>

void dump(char *delim, unsigned char *actual, int smlen)
{
for (int i = 0; i < smlen; i++)
  {
    printf("%s0x%.2x", delim, actual[i]); delim = i % 16 == 15 ? ",\n" : ",";
  }
putchar ('\n');
}

#include "tweetnacl.light.i"

int main(void)
{
unsigned long long mlen = -1;
unsigned long long smlen = -1;
unsigned long long n = 8;
unsigned char secret_key[64] = {
0x3b,0xc1,0x83,0xf6,0xdb,0x5c,0xe6,0x96,0xc1,0xfd,0x0b,0xc2,0x2b,0x55,0xbb,0x4d,
0xf5,0x4e,0x99,0xde,0x19,0x62,0x58,0x0e,0x67,0x6d,0x90,0xbf,0x3e,0x86,0x84,0xc6,
0x68,0x23,0xc6,0xec,0x4d,0x60,0xbc,0xe0,0x43,0xc1,0x67,0x63,0xf3,0x63,0x9c,0x7a,
0x87,0x9b,0x63,0x40,0x11,0x31,0xd8,0x9e,0xd1,0x71,0xbe,0xfa,0xda,0x3f,0x01,0xf7};
unsigned char plain_text[64] = {
0x5a,0xa4,0x9f,0x84,0xce,0x4b,0x35,0xb9,0x2c,0xa5,0xde,0x84,0xaf,0xbc,0xeb,0xc1,
0x45,0x00,0x7f,0xf3,0x17,0xd4,0xaa,0x84,0x06,0x1b,0xac,0x7b,0xce,0x2d,0x7c,0x50,
0xc2,0xf3,0x6d,0xc2,0x91,0xe9,0x05,0x0c,0xfb,0x5d,0x13,0x68,0x9b,0xd2,0xcf,0x6d,
0x48,0x58,0xac,0x9d,0xe9,0x0f,0xd5,0xe4,0x28,0xe5,0xc8,0xe5,0x5f,0xa3,0x4f,0xfb};
unsigned char signed_text[128] = {
0xcd,0xc7,0xba,0xb2,0xcd,0x61,0x9e,0xb8,0x16,0x4f,0xc6,0xdb,0x5d,0xf1,0xf9,0x30,
0xbb,0x20,0xdb,0xd3,0x0c,0xb4,0xb8,0x81,0xbe,0xb6,0x4f,0x79,0xde,0xf7,0x58,0x54,
0x65,0x14,0x68,0x55,0x14,0x8a,0x09,0xbc,0x5e,0x6e,0x62,0x6a,0x7a,0xa3,0x19,0x28,
0x51,0xb4,0x2a,0x38,0x80,0x75,0xc9,0x0e,0xcd,0x86,0x89,0xd6,0x20,0x92,0xcb,0x0c,
0x5a,0xa4,0x9f,0x84,0xce,0x4b,0x35,0xb9,0x2c,0xa5,0xde,0x84,0xaf,0xbc,0xeb,0xc1,
0x45,0x00,0x7f,0xf3,0x17,0xd4,0xaa,0x84,0x06,0x1b,0xac,0x7b,0xce,0x2d,0x7c,0x50,
0xc2,0xf3,0x6d,0xc2,0x91,0xe9,0x05,0x0c,0xfb,0x5d,0x13,0x68,0x9b,0xd2,0xcf,0x6d,
0x48,0x58,0xac,0x9d,0xe9,0x0f,0xd5,0xe4,0x28,0xe5,0xc8,0xe5,0x5f,0xa3,0x4f,0xfb};
unsigned char actual[128];

crypto_sign_ed25519_tweet(actual,&smlen,plain_text,sizeof(plain_text),secret_key);
dump("actual:\n", actual, smlen);
int cmp = memcmp(signed_text,actual,128);
if (!cmp) puts("\nPASS"); else puts("\nFAIL");
}
